<Window x:Class="Notation.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Notation.Views"
        xmlns:converters="clr-namespace:Notation.Converters"
        mc:Ignorable="d"
        WindowState="Maximized"
        Loaded="Window_Loaded"
        Title="Notation 2.0" Height="1080" Width="1920"
        FocusManager.FocusedElement="{Binding ElementName=LoginText}">
    <Window.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
            <GradientStop Offset="0" Color="{Binding Parameters.BaseParameters.Color}"></GradientStop>
            <GradientStop Offset="0.5" Color="{Binding Parameters.BaseParameters.Color}"></GradientStop>
            <GradientStop Offset="1.5" Color="Black"></GradientStop>
        </LinearGradientBrush>
    </Window.Background>
    <Window.Resources>
        <converters:AdminToVisibilityConverter x:Key="AdminToVisibilityConverter"></converters:AdminToVisibilityConverter>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"></converters:BooleanToVisibilityConverter>
        <converters:CountToLibelleConverter x:Key="CountToLibelleConverter"></converters:CountToLibelleConverter>
        <converters:ObjectToVisibilityConverter x:Key="ObjectToVisibilityConverter"></converters:ObjectToVisibilityConverter>
        <converters:ObjectToNotVisibilityConverter x:Key="ObjectToNotVisibilityConverter"></converters:ObjectToNotVisibilityConverter>
        <converters:SubjectToNameConverter x:Key="SubjectToNameConverter"></converters:SubjectToNameConverter>
        <converters:YearToLibelleConverter x:Key="YearToLibelleConverter"></converters:YearToLibelleConverter>
        <converters:YearToVisibilityConverter x:Key="YearToVisibilityConverter"></converters:YearToVisibilityConverter>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="40"></RowDefinition>
            <RowDefinition Height="40"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>
        <TextBlock Grid.Row="0" Grid.RowSpan="2" Height="70">
            <TextBlock.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Offset="0" Color="White"></GradientStop>
                    <GradientStop Offset="0.5" Color="#AFFFFFFF"></GradientStop>
                    <GradientStop Offset="1" Color="White"></GradientStop>
                </LinearGradientBrush>
            </TextBlock.Background>
        </TextBlock>
        <TextBlock Grid.Row="0" Grid.RowSpan="2" Height="2" Background="#50000000" VerticalAlignment="Stretch"></TextBlock>
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"></ColumnDefinition>
                <ColumnDefinition Width="140"></ColumnDefinition>
                <ColumnDefinition Width="140"></ColumnDefinition>
                <ColumnDefinition Width="280"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Base :"></TextBlock>
                <TextBlock Grid.Column="1" Text="{Binding Parameters.BaseParameters.Name}"></TextBlock>
            </Grid>
            <Button Grid.Column="1" Command="{Binding RefreshCommand}">
                <StackPanel Orientation="Horizontal">
                    <Image Source="{StaticResource Refresh}" Width="30" Height="30"></Image>
                    <TextBlock Text="Rafraîchir"></TextBlock>
                </StackPanel>
            </Button>
            <Button Grid.Column="2" Command="{Binding HelpCommand}">
                <StackPanel Orientation="Horizontal">
                    <Image Source="{StaticResource Help}" Width="30" Height="30"></Image>
                    <TextBlock Text="Aide"></TextBlock>
                </StackPanel>
            </Button>
            <Button Grid.Column="3" Command="{Binding BackupCommand}">
                <StackPanel Orientation="Horizontal">
                    <Image Source="{StaticResource Base}" Width="30" Height="30"></Image>
                    <TextBlock Text="Exporter la base de données"></TextBlock>
                </StackPanel>
            </Button>
        </Grid>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"></ColumnDefinition>
                <ColumnDefinition Width="*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                    <ColumnDefinition Width="150"></ColumnDefinition>
                    <ColumnDefinition Width="140"></ColumnDefinition>
                    <ColumnDefinition Width="140"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Année :"></TextBlock>
                <ComboBox Grid.Column="1" ItemsSource="{Binding Years}" SelectedItem="{Binding SelectedYear}">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Converter={StaticResource YearToLibelleConverter}}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Button Grid.Column="2" Command="{Binding AddYearCommand}">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                        <TextBlock Text="Ajouter"></TextBlock>
                    </StackPanel>
                </Button>
                <Button Grid.Column="3" Command="{Binding DeleteYearCommand}">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                        <TextBlock Text="Supprimer"></TextBlock>
                    </StackPanel>
                </Button>
            </Grid>
            <Grid Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Button Grid.Column="0" Command="{Binding LoginCommand}" Click="Login_Click">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{StaticResource User}" Width="30" Height="30"></Image>
                        <TextBlock Text="Changer d'utilisateur"></TextBlock>
                    </StackPanel>
                </Button>
                <Grid Grid.Column="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Utilisateur :"></TextBlock>
                    <TextBlock Grid.Column="1" Text="{Binding User.Name}"/>
                </Grid>
            </Grid>
        </Grid>
        <Image Grid.Row="2" Source="{StaticResource Background}" HorizontalAlignment="Stretch"
                Visibility="{Binding User, Converter={StaticResource ObjectToNotVisibilityConverter}}"></Image>
        <Grid Grid.Row="2" Width="400" Height="160"
              Visibility="{Binding User, Converter={StaticResource ObjectToNotVisibilityConverter}}" Background="#AFFFFFFF">
            <Border BorderThickness="2" BorderBrush="Black" CornerRadius="5"></Border>
            <Grid Margin="5" DataContext="{Binding Login}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"></RowDefinition>
                    <RowDefinition Height="2*"></RowDefinition>
                    <RowDefinition Height="*"></RowDefinition>
                </Grid.RowDefinitions>
                <TextBlock Text="Authentification"></TextBlock>
                <Grid Grid.Column="0" Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"></ColumnDefinition>
                        <ColumnDefinition Width="3*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Column="0" Grid.Row="0" Text="Login :"></TextBlock>
                    <TextBlock Grid.Column="0" Grid.Row="1" Text="Mot de passe :"></TextBlock>
                    <TextBox Name="LoginText" Grid.Column="1" Grid.Row="0" Text="{Binding Login}" KeyDown="LoginText_KeyDown"></TextBox>
                    <PasswordBox Name="Password" Grid.Column="1" Grid.Row="1" PasswordChanged="PasswordBox_PasswordChanged" KeyDown="Password_KeyDown"></PasswordBox>
                </Grid>
                <Grid Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Button Name="Validate" Grid.Column="1" Command="{Binding ValidateCommand}">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                            <TextBlock Text="Valider"></TextBlock>
                        </StackPanel>
                    </Button>
                </Grid>
            </Grid>
        </Grid>
        <TabControl Grid.Row="2" TabStripPlacement="Left" Visibility="{Binding User, Converter={StaticResource ObjectToVisibilityConverter}}">
            <TabItem Visibility="{Binding User, Converter={StaticResource AdminToVisibilityConverter}}" Name="ParametersTab" IsVisibleChanged="ParametersTab_IsVisibleChanged">
                <TabItem.Header>
                    <StackPanel Orientation="Vertical">
                        <Image Source="{StaticResource Parameters}" Height="60" Width="60"></Image>
                        <TextBlock Text="Paramétrage" FontWeight="Bold"></TextBlock>
                    </StackPanel>
                </TabItem.Header>
                <TabControl Visibility="{Binding DataContext.User, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type TabControl}}, Converter={StaticResource AdminToVisibilityConverter}}" DataContext="{Binding Parameters}">
                    <TabItem Header="Niveaux">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" Grid.RowSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="60"></ColumnDefinition>
                                    <ColumnDefinition Width="60"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddLevelCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Name="ModifyLevel" Command="{Binding ModifyLevelCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Modify}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Modifier"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="2" Command="{Binding DeleteLevelCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Supprimer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="3" Command="{Binding UpLevelCommand}">
                                    <Image Source="{StaticResource Up}" Width="30" Height="30"></Image>
                                </Button>
                                <Button Grid.Column="4" Command="{Binding DownLevelCommand}">
                                    <Image Source="{StaticResource Down}" Width="30" Height="30"></Image>
                                </Button>
                                <TextBlock Grid.Column="6" Text="{Binding Levels.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Level}"
                                           FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                            </Grid>
                            <DataGrid Grid.Row="1" ItemsSource="{Binding Levels}" SelectedItem="{Binding SelectedLevel}"
                                      AutoGenerateColumns="False" IsReadOnly="True" MouseDoubleClick="Level_MouseDoubleClick" SelectionMode="Single" CanUserSortColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Name}" Header="Nom" Width="*"></DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationLevel, Converter={StaticResource ObjectToNotVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddLevelCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationLevel, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SaveLevelCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelLevelCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1" Grid.Row="1" Visibility="{Binding ModificationLevel, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"></RowDefinition>
                                    <RowDefinition Height="20"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="4" Orientation="Horizontal" Background="LightGray">
                                    <TextBlock Text="Niveau"></TextBlock>
                                    <TextBlock Text="{Binding ModificationLevel.Name}"></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="2" Text="Nom :" TextAlignment="Right"></TextBlock>
                                <TextBox Grid.Column="1" Grid.Row="2" Text="{Binding ModificationLevel.Name}"></TextBox>
                                <Expander Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4" Header="Matières :" IsExpanded="True" Background="LightGray">
                                    <Grid Background="White">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="35"></RowDefinition>
                                            <RowDefinition Height="Auto"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid Grid.Row="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Button Grid.Column="0" Command="{Binding AddLevelSubjectsCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Ajouter"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Grid.Column="1" Command="{Binding DeleteLevelSubjectCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Supprimer"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <TextBlock Grid.Column="3" Text="{Binding ModificationLevel.Subjects.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Subject}"
                                                FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                                        </Grid>
                                        <DataGrid Grid.Row="1" ItemsSource="{Binding ModificationLevel.Subjects}" SelectedItem="{Binding ModificationLevel.SelectedSubject}" MaxHeight="300"
                                            AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" FontSize="18" CanUserSortColumns="False">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Converter={StaticResource SubjectToNameConverter}}" Header="Nom" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding Coefficient}" Header="Coefficient" Width="*"></DataGridTextColumn>
                                                <DataGridCheckBoxColumn Binding="{Binding Option}" Header="Option" Width="*"></DataGridCheckBoxColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Expander>
                                <TextBlock Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="4" Grid.RowSpan="3" Background="White" VerticalAlignment="Stretch" Margin="0" Panel.ZIndex="-1"></TextBlock>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Matières">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" Grid.RowSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="60"></ColumnDefinition>
                                    <ColumnDefinition Width="60"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddSubjectCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Name="ModifySubject" Command="{Binding ModifySubjectCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Modify}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Modifier"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="2" Command="{Binding DeleteSubjectCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Supprimer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="3" Command="{Binding UpSubjectCommand}">
                                    <Image Source="{StaticResource Up}" Width="30" Height="30"></Image>
                                </Button>
                                <Button Grid.Column="4" Command="{Binding DownSubjectCommand}">
                                    <Image Source="{StaticResource Down}" Width="30" Height="30"></Image>
                                </Button>
                                <TextBlock Grid.Column="6" Text="{Binding Subjects.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Subject}"
                                           FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                            </Grid>
                            <DataGrid Grid.Row="1" ItemsSource="{Binding Subjects}" SelectedItem="{Binding SelectedSubject}"
                                      AutoGenerateColumns="False" IsReadOnly="True" MouseDoubleClick="Subject_MouseDoubleClick" SelectionMode="Single" CanUserSortColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Converter={StaticResource SubjectToNameConverter}}" Header="Nom" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Coefficient}" Header="Coefficient" Width="*"></DataGridTextColumn>
                                    <DataGridCheckBoxColumn Binding="{Binding Option}" Header="Option" Width="*"></DataGridCheckBoxColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationSubject, Converter={StaticResource ObjectToNotVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddSubjectCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationSubject, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SaveSubjectCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelSubjectCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1" Grid.Row="1" Visibility="{Binding ModificationSubject, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"></RowDefinition>
                                    <RowDefinition Height="20"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="4" Orientation="Horizontal" Background="LightGray">
                                    <TextBlock Text="Matière"></TextBlock>
                                    <TextBlock Text="{Binding ModificationSubject.Name}"></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="2" Text="Nom :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="3" Text="Coefficient :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="5" Text="Matière parente :" TextAlignment="Right"></TextBlock>
                                <TextBox Grid.Column="1" Grid.Row="2" Text="{Binding ModificationSubject.Name}"></TextBox>
                                <TextBox Grid.Column="1" Grid.Row="3" Text="{Binding ModificationSubject.Coefficient}"></TextBox>
                                <CheckBox Grid.Column="1" Grid.Row="4" Content="Option" IsChecked="{Binding ModificationSubject.Option}"></CheckBox>
                                <ComboBox Grid.Column="1" Grid.Row="5" ItemsSource="{Binding ModificationSubject.ParentsSubjects}" SelectedItem="{Binding ModificationSubject.ParentSubject}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}"></TextBlock>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <Expander Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="6" Header="Niveaux :" IsExpanded="True" Background="LightGray">
                                    <Grid Background="White">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="35"></RowDefinition>
                                            <RowDefinition Height="Auto"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid Grid.Row="0" Grid.Column="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Button Grid.Column="0" Command="{Binding AddSubjectLevelsCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Ajouter"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Grid.Column="1" Command="{Binding DeleteSubjectLevelCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Supprimer"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <TextBlock Grid.Column="3" Text="{Binding ModificationSubject.Levels.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Level}"
                                                FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                                        </Grid>
                                        <DataGrid Grid.Row="1" Grid.Column="0" ItemsSource="{Binding ModificationSubject.Levels}" SelectedItem="{Binding ModificationSubject.SelectedLevel}"
                                          AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" FontSize="18" CanUserSortColumns="False" MaxHeight="300">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Name}" Header="Nom" Width="*"></DataGridTextColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Expander>
                                <Expander Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="7" Header="Professeurs :" IsExpanded="True" Background="LightGray">
                                    <Grid Background="White">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="35"></RowDefinition>
                                            <RowDefinition Height="Auto"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid Grid.Row="0" Grid.Column="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Button Grid.Column="0" Command="{Binding AddSubjectTeachersCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Ajouter"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Grid.Column="1" Command="{Binding DeleteSubjectTeacherCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Supprimer"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <TextBlock Grid.Column="3" Text="{Binding ModificationSubject.Teachers.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Teacher}"
                                                FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                                        </Grid>
                                        <DataGrid Grid.Row="1" Grid.Column="0" ItemsSource="{Binding ModificationSubject.Teachers}" SelectedItem="{Binding ModificationSubject.SelectedTeacher}"
                                          AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" FontSize="18" CanUserSortColumns="False" MaxHeight="300">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Title}" Header="Titre" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding LastName}" Header="Nom" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding FirstName}" Header="Prénom" Width="*"></DataGridTextColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Expander>
                                <TextBlock Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="4" Grid.RowSpan="7" Background="White" VerticalAlignment="Stretch" Margin="0" Panel.ZIndex="-1"></TextBlock>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Professeurs">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" Grid.RowSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddTeacherCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Name="ModifyTeacher" Command="{Binding ModifyTeacherCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Modify}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Modifier"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="2" Command="{Binding DeleteTeacherCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Supprimer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <TextBlock Grid.Column="6" Text="{Binding Teachers.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Teacher}"
                                           FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                            </Grid>
                            <DataGrid Grid.Row="1" ItemsSource="{Binding Teachers}" SelectedItem="{Binding SelectedTeacher}"
                                      AutoGenerateColumns="False" IsReadOnly="True" MouseDoubleClick="Teacher_MouseDoubleClick" SelectionMode="Single" CanUserSortColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Title}" Header="Titre" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding LastName}" Header="Nom" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding FirstName}" Header="Prénom" Width="*"></DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationTeacher, Converter={StaticResource ObjectToNotVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddTeacherCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1" Grid.Row="0" Visibility="{Binding ModificationTeacher, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SaveTeacherCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelTeacherCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1" Grid.Row="1" Visibility="{Binding ModificationTeacher, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"></RowDefinition>
                                    <RowDefinition Height="20"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="4" Orientation="Horizontal" Background="LightGray">
                                    <TextBlock Text="Professeur"></TextBlock>
                                    <TextBlock Text="{Binding ModificationTeacher.Title}"></TextBlock>
                                    <TextBlock Text="{Binding ModificationTeacher.LastName}"></TextBlock>
                                    <TextBlock Text="{Binding ModificationTeacher.FirstName}"></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="2" Text="Titre :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="3" Text="Nom :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="4" Text="Prénom :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="5" Text="Login :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="6" Text="Mot de passe :" TextAlignment="Right"></TextBlock>
                                <ComboBox Grid.Column="1" Name="ComboTeacherTitle" Grid.Row="2" SelectedItem="{Binding ModificationTeacher.Title}"></ComboBox>
                                <TextBox Grid.Column="1" Grid.Row="3" Text="{Binding ModificationTeacher.LastName}"></TextBox>
                                <TextBox Grid.Column="1" Grid.Row="4" Text="{Binding ModificationTeacher.FirstName}"></TextBox>
                                <TextBox Grid.Column="1" Grid.Row="5" Text="{Binding ModificationTeacher.Login}"></TextBox>
                                <TextBox Grid.Column="1" Grid.Row="6" Text="{Binding ModificationTeacher.Password}"></TextBox>
                                <Expander Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="7" Header="Matières :" IsExpanded="True" Background="LightGray">
                                    <Grid Background="White">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="35"></RowDefinition>
                                            <RowDefinition Height="Auto"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Button Grid.Column="0" Command="{Binding AddTeacherSubjectsCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Ajouter"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Grid.Column="1" Command="{Binding DeleteTeacherSubjectCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Supprimer"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <TextBlock Grid.Column="3" Text="{Binding ModificationTeacher.Subjects.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Subject}"
                                                FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                                        </Grid>
                                        <DataGrid Grid.Row="1" Grid.Column="0" ItemsSource="{Binding ModificationTeacher.Subjects}" SelectedItem="{Binding ModificationTeacher.SelectedSubject}"
                                          AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" FontSize="18" CanUserSortColumns="False" MaxHeight="300">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Converter={StaticResource SubjectToNameConverter}}" Header="Nom" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding Coefficient}" Header="Coefficient" Width="*"></DataGridTextColumn>
                                                <DataGridCheckBoxColumn Binding="{Binding Option}" Header="Option" Width="*"></DataGridCheckBoxColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Expander>
                                <Expander Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="8" Header="Classes :" IsExpanded="True" Background="LightGray">
                                    <Grid Background="White">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="35"></RowDefinition>
                                            <RowDefinition Height="Auto"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid Grid.Row="0" Grid.Column="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Button Grid.Column="0" Command="{Binding AddTeacherClassesCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Ajouter"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Grid.Column="1" Command="{Binding DeleteTeacherClassCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Supprimer"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <TextBlock Grid.Column="3" Text="{Binding ModificationTeacher.Classes.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Class}"
                                                FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                                        </Grid>
                                        <DataGrid Grid.Row="1" Grid.Column="0" ItemsSource="{Binding ModificationTeacher.Classes}" SelectedItem="{Binding ModificationTeacher.SelectedClass}"
                                          AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" FontSize="18" CanUserSortColumns="False" MaxHeight="300">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Name}" Header="Nom" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding Level.Name}" Header="Niveau" Width="*"></DataGridTextColumn>
                                                <DataGridTemplateColumn Header="Professeur principal" Width="*">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding MainTeacher.Title}"></TextBlock>
                                                                <TextBlock Text="{Binding MainTeacher.LastName}"></TextBlock>
                                                                <TextBlock Text="{Binding MainTeacher.Firstname}"></TextBlock>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Expander>
                                <TextBlock Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="4" Grid.RowSpan="8" Background="White" VerticalAlignment="Stretch" Margin="0" Panel.ZIndex="-1"></TextBlock>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Classes">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" Grid.RowSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="50"></ColumnDefinition>
                                    <ColumnDefinition Width="50"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddClassCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Name="ModifyClass" Command="{Binding ModifyClassCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Modify}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Modifier"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="2" Command="{Binding DeleteClassCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Supprimer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="3" Command="{Binding UpClassCommand}">
                                    <Image Source="{StaticResource Up}" Width="30" Height="30"></Image>
                                </Button>
                                <Button Grid.Column="4" Command="{Binding DownClassCommand}">
                                    <Image Source="{StaticResource Down}" Width="30" Height="30"></Image>
                                </Button>
                                <TextBlock Grid.Column="6" Text="{Binding Classes.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Class}"
                                           FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                            </Grid>
                            <DataGrid Grid.Row="1" ItemsSource="{Binding Classes}" SelectedItem="{Binding SelectedClass}"
                                      AutoGenerateColumns="False" IsReadOnly="True" MouseDoubleClick="Class_MouseDoubleClick" SelectionMode="Single" CanUserSortColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Name}" Header="Nom" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Level.Name}" Header="Niveau" Width="*"></DataGridTextColumn>
                                    <DataGridTemplateColumn Header="Professeur principal" Width="*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding MainTeacher.Title}"></TextBlock>
                                                    <TextBlock Text="{Binding MainTeacher.LastName}"></TextBlock>
                                                    <TextBlock Text="{Binding MainTeacher.FirstName}"></TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationClass, Converter={StaticResource ObjectToNotVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddClassCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationClass, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SaveClassCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelClassCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1" Grid.Row="1" Visibility="{Binding ModificationClass, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"></RowDefinition>
                                    <RowDefinition Height="20"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="4" Orientation="Horizontal" Background="LightGray">
                                    <TextBlock Text="Classe"></TextBlock>
                                    <TextBlock Text="{Binding ModificationClass.Name}"></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="2" Text="Nom :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="3" Text="Niveau :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="4" Text="Prof. principal :" TextAlignment="Right"></TextBlock>
                                <TextBox Grid.Column="1" Grid.Row="2" Text="{Binding ModificationClass.Name}"></TextBox>
                                <ComboBox Grid.Column="1" Grid.Row="3" SelectedItem="{Binding ModificationClass.Level}" ItemsSource="{Binding ModificationClass.Levels}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}"></TextBlock>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <ComboBox Grid.Column="1" Grid.Row="4" SelectedItem="{Binding ModificationClass.MainTeacher}" ItemsSource="{Binding ModificationClass.MainTeachers}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Title}"></TextBlock>
                                                <TextBlock Text="{Binding LastName}"></TextBlock>
                                                <TextBlock Text="{Binding FirstName}"></TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <Expander Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="5" Header="Professeurs :" IsExpanded="True" Background="LightGray">
                                    <Grid Background="White">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="35"></RowDefinition>
                                            <RowDefinition Height="Auto"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid Grid.Row="0" Grid.Column="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Button Grid.Column="0" Command="{Binding AddClassTeachersCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Ajouter"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Grid.Column="1" Command="{Binding DeleteClassTeacherCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Supprimer"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <TextBlock Grid.Column="3" Text="{Binding ModificationClass.Teachers.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Teacher}"
                                                FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                                        </Grid>
                                        <DataGrid Grid.Row="1" Grid.Column="0" ItemsSource="{Binding ModificationClass.Teachers}" SelectedItem="{Binding ModificationClass.SelectedTeacher}"
                                          AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" FontSize="18" CanUserSortColumns="False" MaxHeight="300">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Title}" Header="Titre" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding LastName}" Header="Nom" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding FirstName}" Header="Prénom" Width="*"></DataGridTextColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Expander>
                                <Expander Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="6" Header="Elèves :" IsExpanded="True" Background="LightGray">
                                    <Grid Background="White">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="35"></RowDefinition>
                                            <RowDefinition Height="Auto"></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid Grid.Row="0" Grid.Column="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="140"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Button Grid.Column="0" Command="{Binding AddClassStudentsCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Ajouter"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Grid.Column="1" Command="{Binding DeleteClassStudentCommand}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                                    <TextBlock Text="Supprimer"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <TextBlock Grid.Column="3" Text="{Binding ModificationClass.Students.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Student}"
                                                FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                                        </Grid>
                                        <DataGrid Grid.Row="1" Grid.Column="0" ItemsSource="{Binding ModificationClass.Students}" SelectedItem="{Binding ModificationClass.SelectedStudent}"
                                          AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" FontSize="18" CanUserSortColumns="False" MaxHeight="300">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding LastName}" Header="Nom" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding FirstName}" Header="Prénom" Width="*"></DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding Class.Name}" Header="Classe" Width="*"></DataGridTextColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Expander>
                                <TextBlock Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="4" Grid.RowSpan="6" Background="White" VerticalAlignment="Stretch" Margin="0" Panel.ZIndex="-1"></TextBlock>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Elèves">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" Grid.RowSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddStudentCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Name="ModifyStudent" Command="{Binding ModifyStudentCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Modify}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Modifier"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="2" Command="{Binding DeleteStudentCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Supprimer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <TextBlock Grid.Column="4" Text="{Binding Students.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Student}"
                                           FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                            </Grid>
                            <DataGrid Grid.Row="1" ItemsSource="{Binding Students}" SelectedItem="{Binding SelectedStudent}"
                                      AutoGenerateColumns="False" IsReadOnly="True" MouseDoubleClick="Student_MouseDoubleClick" SelectionMode="Single" CanUserSortColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding LastName}" Header="Nom" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding FirstName}" Header="Prénom" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Class.Name}" Header="Classe" Width="*"></DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationStudent, Converter={StaticResource ObjectToNotVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddStudentCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationStudent, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SaveStudentCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelStudentCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1" Grid.Row="1" Visibility="{Binding ModificationStudent, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"></RowDefinition>
                                    <RowDefinition Height="20"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="4" Orientation="Horizontal" Background="LightGray">
                                    <TextBlock Text="Elève"></TextBlock>
                                    <TextBlock Text="{Binding ModificationStudent.LastName}"></TextBlock>
                                    <TextBlock Text="{Binding ModificationStudent.FirstName}"></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="2" Text="Nom :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="3" Text="Prénom :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="4" Text="Date de naiss. :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="5" Text="Classe :" TextAlignment="Right"></TextBlock>
                                <TextBox Grid.Column="1" Grid.Row="2" Text="{Binding ModificationStudent.LastName}"></TextBox>
                                <TextBox Grid.Column="1" Grid.Row="3" Text="{Binding ModificationStudent.FirstName}"></TextBox>
                                <DatePicker Grid.Column="1" Grid.Row="4" SelectedDate="{Binding ModificationStudent.BirthDate}"></DatePicker>
                                <ComboBox Grid.Column="1" Grid.Row="5" SelectedItem="{Binding ModificationStudent.Class}" ItemsSource="{Binding ModificationStudent.Classes}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}"></TextBlock>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <TextBlock Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="4" Grid.RowSpan="5" Background="White" VerticalAlignment="Stretch" Margin="0" Panel.ZIndex="-1"></TextBlock>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Périodes">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" Grid.RowSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddPeriodCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Name="ModifyPeriod" Command="{Binding ModifyPeriodCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Modify}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Modifier"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="2" Command="{Binding DeletePeriodCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Delete}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Supprimer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <TextBlock Grid.Column="4" Text="{Binding Periods.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=Period}"
                                           FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                            </Grid>
                            <DataGrid Grid.Row="1" ItemsSource="{Binding Periods}" SelectedItem="{Binding SelectedPeriod}" 
                                      AutoGenerateColumns="False" IsReadOnly="True" MouseDoubleClick="Period_MouseDoubleClick" SelectionMode="Single" CanUserSortColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Number}" Header="Numéro" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Trimester}" Header="Trimestre" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding FromDate, StringFormat=dd\/MM\/yyyy}" Header="Du" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding ToDate, StringFormat=dd\/MM\/yyyy}" Header="Au" Width="*"></DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationPeriod, Converter={StaticResource ObjectToNotVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding AddPeriodCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Ajouter"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationPeriod, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SavePeriodCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelPeriodCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1" Grid.Row="1" Visibility="{Binding ModificationPeriod, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"></RowDefinition>
                                    <RowDefinition Height="20"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="3" Orientation="Horizontal" Background="LightGray">
                                    <TextBlock Text="Période"></TextBlock>
                                    <TextBlock Text="{Binding ModificationPeriod.Number}"></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="2" Text="Numéro :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="3" Text="Trimestre :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="4" Text="Du :" TextAlignment="Right"></TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="5" Text="Au :" TextAlignment="Right"></TextBlock>
                                <ComboBox Grid.Column="1" Name="ComboPeriodNumber" Grid.Row="2" SelectedItem="{Binding ModificationPeriod.Number}"></ComboBox>
                                <ComboBox Grid.Column="1" Name="ComboPeriodTrimester" Grid.Row="3" SelectedItem="{Binding ModificationPeriod.Trimester}"></ComboBox>
                                <DatePicker Grid.Column="1" Grid.Row="4" SelectedDate="{Binding ModificationPeriod.FromDate}"></DatePicker>
                                <DatePicker Grid.Column="1" Grid.Row="5" SelectedDate="{Binding ModificationPeriod.ToDate}"></DatePicker>
                                <TextBlock Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="4" Grid.RowSpan="5" Background="White" VerticalAlignment="Stretch" Margin="0" Panel.ZIndex="-1"></TextBlock>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Demi-trimestres">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" Grid.RowSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="50"></ColumnDefinition>
                                    <ColumnDefinition Width="50"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Name="ModifySemiTrimester" Command="{Binding ModifySemiTrimesterCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Modify}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Modifier"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding AddSemiTrimesterPeriodCommand}">
                                    <Image Source="{StaticResource Add}" Width="30" Height="30"></Image>
                                </Button>
                                <Button Grid.Column="2" Command="{Binding DeleteSemiTrimesterPeriodCommand}">
                                    <Image Source="{StaticResource Minus}" Width="30" Height="30"></Image>
                                </Button>
                                <TextBlock Grid.Column="4" Text="{Binding SemiTrimesters.Count, Converter={StaticResource CountToLibelleConverter}, ConverterParameter=SemiTrimester}"
                                           FontStyle="Italic" VerticalAlignment="Bottom" FontSize="18" Foreground="Gray"></TextBlock>
                            </Grid>
                            <DataGrid Grid.Row="1" ItemsSource="{Binding SemiTrimesters}" SelectedItem="{Binding SelectedSemiTrimester}" 
                                      AutoGenerateColumns="False" IsReadOnly="True" MouseDoubleClick="SemiTrimester_MouseDoubleClick" SelectionMode="Single" CanUserSortColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Name}" Header="Nom" Width="*"></DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Period1.Trimester}" Header="Trimestre" Width="*"></DataGridTextColumn>
                                    <DataGridTemplateColumn Header="Période" Width="*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="Période"></TextBlock>
                                                    <TextBlock Text="{Binding Period1.Number}"></TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="Période" Width="*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="Période" Visibility="{Binding Period2, Converter={StaticResource ObjectToVisibilityConverter}}"></TextBlock>
                                                    <TextBlock Text="{Binding Period2.Number}" Visibility="{Binding Period2, Converter={StaticResource ObjectToVisibilityConverter}}"></TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Grid.Row="0" Grid.Column="1" Visibility="{Binding ModificationSemiTrimester, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SaveSemiTrimesterCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelSemiTrimesterCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1" Grid.Row="1" Visibility="{Binding ModificationSemiTrimester, Converter={StaticResource ObjectToVisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"></RowDefinition>
                                    <RowDefinition Height="20"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"></ColumnDefinition>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="3" Orientation="Horizontal" Background="LightGray">
                                    <TextBlock Text="Demi-trimestre de"></TextBlock>
                                    <TextBlock Text="{Binding ModificationSemiTrimester.Name}"></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="2" Text="Nom :" TextAlignment="Right"></TextBlock>
                                <TextBox Grid.Column="1" Grid.Row="2" Text="{Binding ModificationSemiTrimester.Name}"></TextBox>
                                <StackPanel Grid.Column="1" Grid.Row="3" Orientation="Horizontal">
                                    <TextBlock Text="Trimestre"></TextBlock>
                                    <TextBlock Text="{Binding ModificationSemiTrimester.Period1.Trimester}"></TextBlock>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Grid.Row="4" Orientation="Horizontal">
                                    <TextBlock Text="Période"></TextBlock>
                                    <TextBlock Text="{Binding ModificationSemiTrimester.Period1.Number}"></TextBlock>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Grid.Row="5" Orientation="Horizontal" Visibility="{Binding ModificationSemiTrimester.Period2, Converter={StaticResource ObjectToVisibilityConverter}}">
                                    <TextBlock Text="Période"></TextBlock>
                                    <TextBlock Text="{Binding ModificationSemiTrimester.Period2.Number}"></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="4" Grid.RowSpan="5" Background="White" VerticalAlignment="Stretch" Margin="0" Panel.ZIndex="-1"></TextBlock>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Calendrier">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="300"></ColumnDefinition>
                                <ColumnDefinition Width="200"></ColumnDefinition>
                                <ColumnDefinition Width="400"></ColumnDefinition>
                                <ColumnDefinition Width="200"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="5" Grid.RowSpan="3" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <TextBlock Grid.Column="1" Grid.ColumnSpan="3" Grid.Row="0" Background="LightGray" VerticalAlignment="Stretch" Margin="0"></TextBlock>
                            <TextBlock Grid.Column="0" Grid.Row="1" Background="LightGray" VerticalAlignment="Stretch" Margin="0"></TextBlock>
                            <TextBlock Grid.Column="1" Grid.ColumnSpan="3" Grid.Row="1" Background="White" VerticalAlignment="Stretch" Margin="0"></TextBlock>
                            <TextBlock Grid.Column="1" Grid.Row="0" Text="Trimestres :"></TextBlock>
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Demi-trimestres :"></TextBlock>
                            <TextBlock Grid.Column="3" Grid.Row="0" Text="Périodes :"></TextBlock>
                            <TextBlock Grid.Column="0" Grid.Row="1" Text="{Binding Calendar.DatesSummary}" VerticalAlignment="Top"></TextBlock>
                            <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding Calendar.TrimestersSummary}" VerticalAlignment="Top"></TextBlock>
                            <TextBlock Grid.Column="2" Grid.Row="1" Text="{Binding Calendar.SemiTrimestersSummary}" VerticalAlignment="Top"></TextBlock>
                            <TextBlock Grid.Column="3" Grid.Row="1" Text="{Binding Calendar.PeriodsSummary}" VerticalAlignment="Top"></TextBlock>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Notes-professeurs" Visibility="{Binding DataContext.User, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type TabControl}}, Converter={StaticResource AdminToVisibilityConverter}}" DataContext="{Binding Utils}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120"></ColumnDefinition>
                                <ColumnDefinition Width="200"></ColumnDefinition>
                                <ColumnDefinition Width="100"></ColumnDefinition>
                                <ColumnDefinition Width="120"></ColumnDefinition>
                                <ColumnDefinition Width="300"></ColumnDefinition>
                                <ColumnDefinition Width="140"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="35"></RowDefinition>
                                <RowDefinition Height="35"></RowDefinition>
                                <RowDefinition Height="35"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <TextBlock Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="6" Grid.RowSpan="3" VerticalAlignment="Stretch" Background="White"></TextBlock>
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Période :" TextAlignment="Right"></TextBlock>
                            <TextBlock Grid.Column="0" Grid.Row="1" Text="Classe :" TextAlignment="Right"></TextBlock>
                            <TextBlock Grid.Column="0" Grid.Row="2" Text="Matière :" TextAlignment="Right"></TextBlock>
                            <StackPanel Grid.Column="4" Grid.Row="0" Orientation="Horizontal">
                                <TextBlock Text="Nombres de notes :" TextAlignment="Right" FontStyle="Italic"></TextBlock>
                                <TextBlock Text="{Binding NbMarks}" TextAlignment="Right" FontStyle="Italic"></TextBlock>
                            </StackPanel>
                            <StackPanel Grid.Column="4" Grid.Row="1" Orientation="Horizontal">
                                <TextBlock Text="Professseur :" TextAlignment="Right" FontStyle="Italic"></TextBlock>
                                <TextBlock Text="{Binding ActualTeacher.Title}" TextAlignment="Right" FontStyle="Italic"></TextBlock>
                                <TextBlock Text="{Binding ActualTeacher.FirstName}" TextAlignment="Right" FontStyle="Italic"></TextBlock>
                                <TextBlock Text="{Binding ActualTeacher.LastName}" TextAlignment="Right" FontStyle="Italic"></TextBlock>
                            </StackPanel>
                            <TextBlock Grid.Column="3" Grid.Row="2" Text="Professeur :" TextAlignment="Right"></TextBlock>
                            <ComboBox Grid.Column="1" Grid.Row="0" SelectedItem="{Binding SelectedPeriod}" ItemsSource="{Binding Periods}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Période"></TextBlock>
                                            <TextBlock Text="{Binding Number}"></TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <ComboBox Grid.Column="1" Grid.Row="1" SelectedItem="{Binding SelectedClass}" ItemsSource="{Binding Classes}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}"></TextBlock>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <ComboBox Grid.Column="1" Grid.Row="2" SelectedItem="{Binding SelectedSubject}" ItemsSource="{Binding Subjects}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}"></TextBlock>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <ComboBox Grid.Column="4" Grid.Row="2" SelectedItem="{Binding SelectedTeacher}" ItemsSource="{Binding Teachers}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Title}"></TextBlock>
                                            <TextBlock Text="{Binding LastName}"></TextBlock>
                                            <TextBlock Text="{Binding FirstName}"></TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <Button Grid.Column="5" Grid.Row="2" Command="{Binding AffectTeacherMarksCommand}">
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                    <TextBlock Text="Enregistrer"></TextBlock>
                                </StackPanel>
                            </Button>
                            <Image Source="{StaticResource Icon}" Grid.RowSpan="6" Grid.ColumnSpan="7" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Autres options">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="30"></RowDefinition>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.RowSpan="6" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <GroupBox Grid.Row="0" Header="Paramétres" Background="LightGray">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"></ColumnDefinition>
                                        <ColumnDefinition Width="300"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Préfet de division :"></TextBlock>
                                    <TextBox Grid.Column="1" Text="{Binding YearParameters.DivisionPrefect}"></TextBox>
                                </Grid>
                            </GroupBox>
                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SaveYearParametersCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelYearParametersCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Base">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="30"></RowDefinition>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.RowSpan="6" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <GroupBox Grid.Row="0" Header="Base" Background="LightGray">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"></ColumnDefinition>
                                        <ColumnDefinition Width="300"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Column="0" Text="Nom :"></TextBlock>
                                    <TextBox Grid.Column="1" Text="{Binding BaseParameters.Name}"></TextBox>
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row="1" Header="Administrateur" Background="LightGray">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"></ColumnDefinition>
                                        <ColumnDefinition Width="150"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Login :"></TextBlock>
                                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding BaseParameters.AdminLogin}"></TextBox>
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Mot de passe :"></TextBlock>
                                    <PasswordBox Grid.Row="1" Grid.Column="1" Name="AdminPassword" PasswordChanged="AdminPassword_PasswordChanged"></PasswordBox>
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row="2" Header="Couleur de fond" Background="LightGray">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"></ColumnDefinition>
                                        <ColumnDefinition Width="100"></ColumnDefinition>
                                        <ColumnDefinition Width="30"></ColumnDefinition>
                                        <ColumnDefinition Width="30"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Rouge (0-255) :"></TextBlock>
                                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding BaseParameters.ColorR, UpdateSourceTrigger=PropertyChanged}"></TextBox>
                                    <Button Grid.Row="0" Grid.Column="2" Command="{Binding MinusColorRCommand}">
                                        <Image Source="{StaticResource Minus}" Width="20" Height="20"></Image>
                                    </Button>
                                    <Button Grid.Row="0" Grid.Column="3" Command="{Binding PlusColorRCommand}">
                                        <Image Source="{StaticResource Add}" Width="20" Height="20"></Image>
                                    </Button>
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Vert (0-255) :"></TextBlock>
                                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding BaseParameters.ColorG, UpdateSourceTrigger=PropertyChanged}"></TextBox>
                                    <Button Grid.Row="1" Grid.Column="2" Command="{Binding MinusColorGCommand}">
                                        <Image Source="{StaticResource Minus}" Width="20" Height="20"></Image>
                                    </Button>
                                    <Button Grid.Row="1" Grid.Column="3" Command="{Binding PlusColorGCommand}">
                                        <Image Source="{StaticResource Add}" Width="20" Height="20"></Image>
                                    </Button>
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Bleu (0-255) :"></TextBlock>
                                    <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding BaseParameters.ColorB, UpdateSourceTrigger=PropertyChanged}"></TextBox>
                                    <Button Grid.Row="2" Grid.Column="2" Command="{Binding MinusColorBCommand}">
                                        <Image Source="{StaticResource Minus}" Width="20" Height="20"></Image>
                                    </Button>
                                    <Button Grid.Row="2" Grid.Column="3" Command="{Binding PlusColorBCommand}">
                                        <Image Source="{StaticResource Add}" Width="20" Height="20"></Image>
                                    </Button>
                                </Grid>
                            </GroupBox>
                            <Grid Grid.Row="4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="140"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{Binding SaveBaseParametersCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Save}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Enregistrer"></TextBlock>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="1" Command="{Binding CancelBaseParametersCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="{StaticResource Cancel}" Width="30" Height="30"></Image>
                                        <TextBlock Text="Annuler"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>
            <TabItem Visibility="{Binding User, Converter={StaticResource AdminToVisibilityConverter}}">
                <TabItem.Header>
                    <StackPanel Orientation="Vertical">
                        <Image Source="{StaticResource Models}" Height="60" Width="60"></Image>
                        <TextBlock Text="Modèles" FontWeight="Bold"></TextBlock>
                    </StackPanel>
                </TabItem.Header>
                <TabControl Visibility="{Binding DataContext.User, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type TabControl}}, Converter={StaticResource AdminToVisibilityConverter}}" DataContext="{Binding Models}">
                    <TabItem Header="Modèles de période">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <ItemsControl Grid.Column="0" ItemsSource="{Binding Periods}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Click="ExportPeriod_Click">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Période"></TextBlock>
                                                <TextBlock Text="{Binding Number}"></TextBlock>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Button Grid.Row="0" Width="50" HorizontalAlignment="Left" Command="{Binding OpenPeriodModelsPathCommand}">
                                    <Image Source="{StaticResource Folder}" Width="30" Height="30"></Image>
                                </Button>
                                <ProgressBar Grid.Row="1" Name="PeriodModelsProgressBar" Visibility="Collapsed" Maximum="1000" Height="20"></ProgressBar>
                                <ListView Grid.Row="2" VerticalAlignment="Top" ItemsSource="{Binding PeriodModels}" SelectedItem="{Binding SelectedPeriodModel}" MouseDoubleClick="PeriodModel_MouseDoubleClick"></ListView>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Modèles de demi-trimestre">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <ItemsControl ItemsSource="{Binding SemiTrimesters}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Click="ExportSemiTrimester_Click">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Demi-trimestre de"></TextBlock>
                                                <TextBlock Text="{Binding Name}"></TextBlock>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Button Grid.Row="0" Width="50" HorizontalAlignment="Left" Command="{Binding OpenSemiTrimesterModelsPathCommand}">
                                    <Image Source="{StaticResource Folder}" Width="30" Height="30"></Image>
                                </Button>
                                <ProgressBar Grid.Row="1" Name="SemiTrimesterModelsProgressBar" Visibility="Collapsed" Maximum="1000" Height="20"></ProgressBar>
                                <ListView Grid.Row="2" VerticalAlignment="Top" ItemsSource="{Binding SemiTrimesterModels}" SelectedItem="{Binding SelectedSemiTrimesterModel}" MouseDoubleClick="SemiTrimesterModel_MouseDoubleClick"></ListView>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Modèles de trimestre">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <ItemsControl ItemsSource="{Binding Trimesters}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Click="ExportTrimester_Click">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Trimestre"></TextBlock>
                                                <TextBlock Text="{Binding}"></TextBlock>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Button Grid.Row="0" Width="50" HorizontalAlignment="Left" Command="{Binding OpenTrimesterModelsPathCommand}">
                                    <Image Source="{StaticResource Folder}" Width="30" Height="30"></Image>
                                </Button>
                                <ProgressBar Grid.Row="1" Name="TrimesterModelsProgressBar" Visibility="Collapsed" Maximum="1000" Height="20"></ProgressBar>
                                <ListView Grid.Row="2" VerticalAlignment="Top" ItemsSource="{Binding TrimesterModels}" SelectedItem="{Binding SelectedTrimesterModel}" MouseDoubleClick="TrimesterModel_MouseDoubleClick"></ListView>
                            </Grid>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>
            <TabItem Name="EntryTab" IsSelected="true" DataContext="{Binding Entry}">
                <TabItem.Header>
                    <StackPanel Orientation="Vertical">
                        <Image Source="{StaticResource Entry}" Height="60" Width="60"></Image>
                        <TextBlock Text="Saisie" FontWeight="Bold"></TextBlock>
                    </StackPanel>
                </TabItem.Header>
                <TabControl Visibility="{Binding DataContext.User, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type TabControl}}, Converter={StaticResource AdminToVisibilityConverter}}">
                    <TabItem Header="Import">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="35"></RowDefinition>
                                <RowDefinition Height="3*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.RowSpan="2" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Button Grid.Column="0" Click="Import_Click">
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="{StaticResource Folder}" Width="30" Height="30"></Image>
                                    <TextBlock Text="Importer"></TextBlock>
                                </StackPanel>
                            </Button>
                            <Grid Grid.Row="0" Grid.RowSpan="2" Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Visibility="{Binding SuccessfulImport, Converter={StaticResource BooleanToVisibilityConverter}}" Text="{Binding ImportText}"></TextBlock>
                                <ProgressBar Grid.Row="1" Name="ImportProgressBar" Visibility="Collapsed" Maximum="1000" Height="20" VerticalAlignment="Top"></ProgressBar>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Saisie manuelle">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <StackPanel Grid.Column="0">
                                <Button Content="Notes" Command="{Binding EntryMarksCommand}"></Button>
                                <Button Content="Appréciations générales de période" Command="{Binding EntryPeriodCommentsCommand}"
                                Visibility="{Binding DataContext.User, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}, Converter={StaticResource AdminToVisibilityConverter}}"></Button>
                                <Button Content="Appréciations générales de demi-trimestre" Command="{Binding EntrySemiTrimesterCommentsCommand}"
                                Visibility="{Binding DataContext.User, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}, Converter={StaticResource AdminToVisibilityConverter}}"></Button>
                                <Button Content="Appréciations de matières de trimestre" Command="{Binding EntryTrimesterSubjectCommentsCommand}"></Button>
                                <Button Content="Appréciations générales de trimestre" Command="{Binding EntryTrimesterCommentsCommand}"
                                Visibility="{Binding DataContext.User, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}, Converter={StaticResource AdminToVisibilityConverter}}"></Button>
                            </StackPanel>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>
            <TabItem Visibility="{Binding User, Converter={StaticResource AdminToVisibilityConverter}}">
                <TabItem.Header>
                    <StackPanel Orientation="Vertical">
                        <Image Source="{StaticResource Reports}" Height="60" Width="60"></Image>
                        <TextBlock Text="Bulletins" FontWeight="Bold"></TextBlock>
                    </StackPanel>
                </TabItem.Header>
                <TabControl Visibility="{Binding DataContext.User, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type TabControl}}, Converter={StaticResource AdminToVisibilityConverter}}" DataContext="{Binding Reports}">
                    <TabItem Header="Bulletins de période">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <ItemsControl ItemsSource="{Binding Periods}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Click="ReportPeriod_Click">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Période"></TextBlock>
                                                <TextBlock Text="{Binding Number}"></TextBlock>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Button Grid.Row="0" Width="50" HorizontalAlignment="Left" Command="{Binding OpenPeriodReportsPathCommand}">
                                    <Image Source="{StaticResource Folder}" Width="30" Height="30"></Image>
                                </Button>
                                <ProgressBar Grid.Row="1" Name="PeriodReportsProgressBar" Visibility="Collapsed" Maximum="1000" Height="20"></ProgressBar>
                                <ListView Grid.Row="2" VerticalAlignment="Top" MouseDoubleClick="PeriodReport_MouseDoubleClick"
                                    ItemsSource="{Binding PeriodReports}" SelectedItem="{Binding SelectedPeriodReport}"></ListView>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Bulletins de demi-trimestre">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <ItemsControl ItemsSource="{Binding SemiTrimesters}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Click="ReportSemiTrimester_Click">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Demi-trimestre de"></TextBlock>
                                                <TextBlock Text="{Binding Name}"></TextBlock>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Button Grid.Row="0" Width="50" HorizontalAlignment="Left" Command="{Binding OpenSemiTrimesterReportsPathCommand}">
                                    <Image Source="{StaticResource Folder}" Width="30" Height="30"></Image>
                                </Button>
                                <ProgressBar Grid.Row="1" Name="SemiTrimesterReportsProgressBar" Visibility="Collapsed" Maximum="1000" Height="20"></ProgressBar>
                                <ListView Grid.Row="2" VerticalAlignment="Top" MouseDoubleClick="SemiTrimesterReport_MouseDoubleClick"
                                    ItemsSource="{Binding SemiTrimesterReports}" SelectedItem="{Binding SelectedSemiTrimesterReport}"></ListView>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Bulletins de trimestre">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <ItemsControl ItemsSource="{Binding Trimesters}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Click="ReportTrimester_Click">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Trimestre"></TextBlock>
                                                <TextBlock Text="{Binding}"></TextBlock>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Button Grid.Row="0" Width="50" HorizontalAlignment="Left" Command="{Binding OpenTrimesterReportsPathCommand}">
                                    <Image Source="{StaticResource Folder}" Width="30" Height="30"></Image>
                                </Button>
                                <ProgressBar Grid.Row="1" Name="TrimesterReportsProgressBar" Visibility="Collapsed" Maximum="1000" Height="20"></ProgressBar>
                                <ListView Grid.Row="2" VerticalAlignment="Top" MouseDoubleClick="TrimesterReport_MouseDoubleClick"
                                    ItemsSource="{Binding TrimesterReports}" SelectedItem="{Binding SelectedTrimesterReport}"></ListView>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Bulletins annuels">
                        <Grid>
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="0.75" Color="AliceBlue"></GradientStop>
                                    <GradientStop Offset="2" Color="Black"></GradientStop>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Image Source="{StaticResource Icon}" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Height="158" Width="158"></Image>
                            <Grid Grid.Column="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Button Click="ReportYear_Click" Visibility="{Binding Year, Converter={StaticResource YearToVisibilityConverter}}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Année"></TextBlock>
                                        <TextBlock Text="{Binding Year}"></TextBlock>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Button Grid.Row="0" Width="50" HorizontalAlignment="Left" Command="{Binding OpenYearReportsPathCommand}">
                                    <Image Source="{StaticResource Folder}" Width="30" Height="30"></Image>
                                </Button>
                                <ProgressBar Grid.Row="1" Name="YearReportsProgressBar" Visibility="Collapsed" Maximum="1000" Height="20"></ProgressBar>
                                <ListView Grid.Row="2" VerticalAlignment="Top" MouseDoubleClick="YearReport_MouseDoubleClick"
                                    ItemsSource="{Binding YearReports}" SelectedItem="{Binding SelectedYearReport}"></ListView>
                            </Grid>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
